---
import SiteLayout from '../layouts/SiteLayout.astro';
import BlogPostPreview from "../components/BlogPostPreview.astro";

let title = "Example Blog";
let description = "The perfect starter for your perfect blog.";

// Use Astro.glob to fetch all post with associated frontmatter
const unsortedPosts = await Astro.glob("./posts/*.md");
const posts = unsortedPosts.sort(function (a, b) {
	return (
		new Date(b.frontmatter.publishDate).valueOf() - new Date(a.frontmatter.publishDate).valueOf()
	);
});
---
<SiteLayout title={title} description={description}>
	<div class="wrapper">
		<main class="content">
			<section class="intro">
				<h1>{title}</h1>
				<p>{description}</p>
			</section>
			<section aria-label="Blog post list">
				{posts.map(({ url, frontmatter }) => (
					<BlogPostPreview
						title={frontmatter.title}
						description={frontmatter.description}
						publishDate={frontmatter.publishDate}
						url={url}
					/>
				))}
			</section>	
		</main>
	</div>
</SiteLayout>
